<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>No-Cookie YouTube Player</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
<style>
html, body {
  margin: 0;
  padding: 0;
  width: 100%;
  height: 100%;
  font-family: 'Inter', sans-serif;
  background: #121212;
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: flex-start; /* prevent cutoff on small screens */
  overflow: hidden; /* start hidden, JS will toggle */
}

body::-webkit-scrollbar { width: 12px; }
body::-webkit-scrollbar-track { background: #1e1e1e; border-radius: 6px; }
body::-webkit-scrollbar-thumb { background-color: #888; border-radius: 6px; border: 3px solid #1e1e1e; }

.player-container {
  width: 100%;
  max-width: 900px;
  display: flex;
  flex-direction: column;
  gap: 15px;
  padding: 20px;
  box-sizing: border-box;
}

iframe {
  width: 100%;
  aspect-ratio: 16/9;
  border: none;
  border-radius: 12px;
  background: #000;
}

.video-info {
  font-size: 1.2rem;
  font-weight: 600;
  padding: 10px 15px;
  background: #1e1e1e;
  border-radius: 8px;
  text-align: center;
  word-wrap: break-word;
}

button {
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  background: #ff3b3f;
  color: #fff;
  font-weight: 600;
  cursor: pointer;
  transition: 0.2s;
}
button:hover { background: #ff6166; }

.input-group {
  display: flex;
  gap: 10px;
  margin-top: 10px;
  flex-wrap: wrap; /* allows wrapping on small screens */
}
input[type="text"] {
  flex: 1;
  padding: 10px 15px;
  border-radius: 8px;
  border: 1px solid #333;
  background: #1e1e1e;
  color: #fff;
  font-size: 1rem;
  min-width: 0; /* prevents overflow */
}
input[type="text"]::placeholder { color: #888; }

.video-result {
  display: flex;
  gap: 10px;
  align-items: center;
  padding: 10px;
  background: #1e1e1e;
  border-radius: 8px;
  cursor: pointer;
  transition: 0.2s;
  margin-top: 8px;
}
.video-result:hover { background: #2a2a2a; }
.video-result img { width: 120px; border-radius: 6px; }

/* Responsive tweaks */
@media (max-width: 600px) {
  .video-info {
    font-size: 1rem;
    padding: 8px 10px;
  }
  button {
    flex: 1;
    padding: 10px;
  }
  .video-result img {
    width: 90px;
  }
}
</style>
</head>
<body>

<div class="player-container">
  <iframe id="youtube-frame" src="https://big-up.netlify.app/pages/youtube/html.html" allowfullscreen></iframe>
  <div class="video-info" id="video-desc">currently watching: nexus ðŸ¥³</div>

  <div class="input-group">
    <input type="text" id="search-input" autocomplete="off" placeholder="Enter video ID/URL or search keywords">
    <button onclick="handleInput()">Go</button>
  </div>

  <div id="search-results"></div>
</div>

<script>
const API_KEY = 'AIzaSyCxyEX4vPW-p959aJkDN_XnrtCyTyM4iQo';

function extractVideoID(url) {
  const regex = /(?:https?:\/\/)?(?:www\.)?youtube(?:-nocookie)?\.com\/watch\?v=([a-zA-Z0-9_-]{11})|([a-zA-Z0-9_-]{11})|(?:https?:\/\/)?youtu\.be\/([a-zA-Z0-9_-]{11})/;
  const match = url.match(regex);
  if(match) return match[1] || match[2] || match[3];
  return null;
}

async function fetchVideoTitle(videoID) {
  try {
    const res = await fetch(`https://www.youtube.com/oembed?url=https://www.youtube-nocookie.com/watch?v=${videoID}&format=json`);
    if(!res.ok) throw new Error("Video not found");
    const data = await res.json();
    return data.title;
  } catch(e) { return "Unknown Video"; }
}

async function loadVideo(videoID) {
  document.getElementById('youtube-frame').src = `https://www.youtube-nocookie.com/embed/${videoID}`;
  document.getElementById('video-desc').innerText = `currently watching: loading...`;
  const title = await fetchVideoTitle(videoID);
  document.getElementById('video-desc').innerText = `currently watching: ${title}`;
}

async function handleInput() {
  const input = document.getElementById('search-input').value.trim();
  if(!input) return;

  const videoID = extractVideoID(input);
  if(videoID) {
    loadVideo(videoID);
    document.getElementById('search-results').innerHTML = '';
    document.body.style.overflow = "hidden"; // hide scrollbar again
    return;
  }

  // Otherwise treat input as search keywords
  const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=10&q=${encodeURIComponent(input)}&key=${API_KEY}`);
  const data = await res.json();
  const resultsDiv = document.getElementById('search-results');
  resultsDiv.innerHTML = '';
  
  // show scrollbars if results exist
  if(data.items.length > 0) document.body.style.overflow = "auto";

  data.items.forEach(item => {
    const vid = item.id.videoId;
    const title = item.snippet.title;
    const thumb = item.snippet.thumbnails.default.url;
    const div = document.createElement('div');
    div.className = 'video-result';
    div.innerHTML = `<img src="${thumb}" alt="${title}"><span>${title}</span>`;
    div.onclick = () => { 
      loadVideo(vid); 
      resultsDiv.innerHTML = ''; 
      document.body.style.overflow = "hidden"; 
    };
    resultsDiv.appendChild(div);
  });
}

document.getElementById('search-input').addEventListener('keydown', e => { if(e.key==='Enter') handleInput(); });
</script>

</body>
</html>

